{"version":3,"sources":["file:///E:/education_game/game/assets/scripts/modules/game/ObjectFactory.ts"],"names":["_decorator","Node","Singleton","GameManager","ObjectBase","RightTriangleObject","SquareObject","ccclass","property","ObjectFactory","init","map_root","getInstance","gameRoot","getChildByName","objects_pre","nextInitManager","setNextInitManager","createObject","type","newNode","setParent","active","component","addComponent","objectType2component","create","push","getObject","shapeParam","pos","objectData","parent","object","shift","node","name","setPosition","givebackObject","destroyObject","destroy","ObjectType","Square","RightTriangle"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAkBC,MAAAA,I,OAAAA,I;;AAClBC,MAAAA,S,iBAAAA,S;;AACAC,MAAAA,W,iBAAAA,W;;AACAC,MAAAA,U,iBAAAA,U;;AACAC,MAAAA,mB,iBAAAA,mB;;AACAC,MAAAA,Y,iBAAAA,Y;;;;;;;;;OAGH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBR,U;;+BAGjBS,a,WADZF,OAAO,CAAC,eAAD,C,gBAAR,MACaE,aADb;AAAA;AAAA,kCACiE;AAItDC,QAAAA,IAAI,GAAG;AACV,eAAKC,QAAL,GAAgB;AAAA;AAAA,0CAAYC,WAAZ,GAA0BC,QAA1B,CAAmCC,cAAnC,CAAkD,UAAlD,CAAhB;AACA,eAAKC,WAAL,GAAmB,EAAnB;;AACA,cAAI,KAAKC,eAAT,EAA0B;AACtB,iBAAKA,eAAL,CAAqBN,IAArB;AACH;AACJ;;AAGMO,QAAAA,kBAAkB,CAACD,eAAD,EAAkC;AACvD,eAAKA,eAAL,GAAuBA,eAAvB;AACH;;AAEME,QAAAA,YAAY,CAACC,IAAD,EAA+B;AAC9C,cAAIC,OAAO,GAAG,IAAInB,IAAJ,EAAd;AACAmB,UAAAA,OAAO,CAACC,SAAR,CAAkB,KAAKV,QAAvB;AACAS,UAAAA,OAAO,CAACE,MAAR,GAAiB,KAAjB;AACA,cAAIC,SAAS,GAAGH,OAAO,CAACI,YAAR,CAAqBC,oBAAoB,CAACN,IAAD,CAAzC,CAAhB;AACAI,UAAAA,SAAS,CAACG,MAAV;AACA,eAAKX,WAAL,CAAiBY,IAAjB,CAAsBJ,SAAtB;AACA,iBAAOA,SAAP;AACH;;AAEMK,QAAAA,SAAS,CAACT,IAAD,EAAmBU,UAAnB,EAAoCC,GAApC,EAA+CC,UAA/C,EAAgEC,MAAhE,EAA2F;AACvG,cAAIC,MAAM,GAAG,KAAKlB,WAAL,CAAiBmB,KAAjB,EAAb;;AACA,cAAI,CAACD,MAAL,EAAa;AACTA,YAAAA,MAAM,GAAG,KAAKf,YAAL,CAAkBC,IAAlB,CAAT;AACAc,YAAAA,MAAM,GAAG,KAAKlB,WAAL,CAAiBmB,KAAjB,EAAT;AACH;;AACDD,UAAAA,MAAM,CAACE,IAAP,CAAYC,IAAZ,GAAmBL,UAAU,CAACK,IAA9B;AACAH,UAAAA,MAAM,CAACE,IAAP,CAAYd,SAAZ,CAAsBW,MAAM,GAAGA,MAAH,GAAY,KAAKrB,QAA7C;AACAsB,UAAAA,MAAM,CAACE,IAAP,CAAYE,WAAZ,CAAwBP,GAAxB;AACAG,UAAAA,MAAM,CAACvB,IAAP,CAAYS,IAAZ,EAAkBU,UAAlB,EAA8BE,UAA9B;AACAE,UAAAA,MAAM,CAACE,IAAP,CAAYb,MAAZ,GAAqB,IAArB;AACA,iBAAOW,MAAP;AACH;;AAEMK,QAAAA,cAAc,CAACL,MAAD,EAAqB;AACtCA,UAAAA,MAAM,CAACE,IAAP,CAAYb,MAAZ,GAAqB,KAArB;AACA,eAAKP,WAAL,CAAiBY,IAAjB,CAAsBM,MAAtB;AACH;;AAEMM,QAAAA,aAAa,CAACN,MAAD,EAAqB;AACrCA,UAAAA,MAAM,CAACE,IAAP,CAAYK,OAAZ;AACH;;AAhD4D,O;;4BAmDrDC,U,0BAAAA,U;AAAAA,QAAAA,U,CAAAA,U;AAAAA,QAAAA,U,CAAAA,U;eAAAA,U;;;AAMNhB,MAAAA,oB,GAAuB;AACzB,SAACgB,UAAU,CAACC,MAAZ,GAAqB;AAAA;AAAA;AAAA;AAAA,qCADI;AAEzB,SAACD,UAAU,CAACE,aAAZ,GAA4B;AAAA;AAAA;AAAA;AAAA;AAFH,O","sourcesContent":["import { _decorator, Vec3, Node } from \"cc\";\nimport { Singleton } from \"../../common/Singleton\";\nimport { GameManager } from \"../../manager/game_manager/GameManager\";\nimport { ObjectBase } from \"./ObjectBase\";\nimport { RightTriangleObject } from \"./game_objects/RightTriangleObject\";\nimport { SquareObject } from \"./game_objects/SquareObject\";\nimport { IPreInit } from \"../../common/IPreInit\";\n\nconst { ccclass, property } = _decorator;\n\n@ccclass('ObjectFactory')\nexport class ObjectFactory extends Singleton implements IPreInit {\n    private map_root: Node;\n    private objects_pre: ObjectBase[];\n\n    public init() {\n        this.map_root = GameManager.getInstance().gameRoot.getChildByName(\"map_root\");\n        this.objects_pre = [];\n        if (this.nextInitManager) {\n            this.nextInitManager.init();\n        }\n    }\n\n    public nextInitManager: IPreInit;\n    public setNextInitManager(nextInitManager: IPreInit): void {\n        this.nextInitManager = nextInitManager;\n    }\n\n    public createObject(type: ObjectType): ObjectBase {\n        let newNode = new Node();\n        newNode.setParent(this.map_root);\n        newNode.active = false;\n        let component = newNode.addComponent(objectType2component[type]);\n        component.create();\n        this.objects_pre.push(component);\n        return component;\n    }\n\n    public getObject(type: ObjectType, shapeParam: any, pos: Vec3, objectData: any, parent?: Node): ObjectBase {\n        let object = this.objects_pre.shift();\n        if (!object) {\n            object = this.createObject(type);\n            object = this.objects_pre.shift();\n        }\n        object.node.name = objectData.name;\n        object.node.setParent(parent ? parent : this.map_root);\n        object.node.setPosition(pos);\n        object.init(type, shapeParam, objectData);\n        object.node.active = true;\n        return object;\n    }\n\n    public givebackObject(object: ObjectBase) {\n        object.node.active = false;\n        this.objects_pre.push(object);\n    }\n\n    public destroyObject(object: ObjectBase) {\n        object.node.destroy();\n    }\n}\n\nexport enum ObjectType {\n    Square = 1,\n    RightTriangle = 2,\n\n}\n\nconst objectType2component = {\n    [ObjectType.Square]: SquareObject || ObjectBase,\n    [ObjectType.RightTriangle]: RightTriangleObject || ObjectBase,\n}\n"]}