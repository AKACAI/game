{"version":3,"sources":["file:///D:/cocos_projects/physics_education_game/assets/scripts/modules/ui/game_start_ui/LevelSelectView.ts"],"names":["_decorator","instantiate","tween","UIOpacity","Vec3","UIPanel","UILayer","LogManager","NodeHelper","LoadType","ResManager","LevelSelectModeItem","ccclass","property","LevelSelectView","node_center","undefined","node_mode_items","btn_close","btn_tip","node_block_click_mask","modeItems","isInAnim","modeItemPath","tweenShowAnimData","animTime","init","_layer","normal","node","getChildByName","setNodeSizeFullScreen","addListener","open","initUI","active","setNodeClickEvent","closeBySelf","modeData","name","bg_path","clickCb","showOneMode","log","getInstance","loadAsset","PrefableRes","bundleName","prefab","error","panelName","i","length","itemCpt","getComponent","setData","addChild","push","index","item","to","position","scale","opacityCpt","opacity","close","dispose"],"mappings":"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","sourcesContent":["import { _decorator, instantiate, Node, Prefab, tween, UIOpacity, Vec2, Vec3 } from \"cc\";\nimport { UIPanel } from \"../../../manager/ui_manager/UIPanel\";\nimport { UILayer } from \"../../../manager/ui_manager/UIManager\";\nimport { GameManager, GameState } from \"../../../manager/game_manager/GameManager\";\nimport LogManager from \"../../../utils/LogManager\";\nimport NodeHelper from \"../../../common/NodeHelper\";\nimport { LoadType, ResManager } from \"../../../manager/ResManager\";\nimport { ISetDataModeItem, LevelSelectModeItem } from \"./LevelSelectModeItem\";\n\nconst { ccclass, property } = _decorator;\n\n@ccclass('LevelSelectView')\nexport class LevelSelectView extends UIPanel {\n    private node_center: Node = undefined;\n    private node_mode_items: Node = undefined;\n\n    private btn_close: Node = undefined;\n    private btn_tip: Node = undefined;\n    private node_block_click_mask: Node = undefined;\n\n    private modeItems: LevelSelectModeItem[] = undefined;\n\n\n    private isInAnim: boolean = undefined;\n    private readonly modeItemPath: string = \"level_select_mode_item\";\n    private readonly tweenShowAnimData = {\n        animTime: 1.2,\n    }\n    public init() {\n        super.init();\n        this._layer = UILayer.normal;\n\n        this.node_center = this.node.getChildByName(\"node_center\");\n        this.node_mode_items = this.node_center.getChildByName(\"node_mode_items\");\n        this.btn_close = this.node_center.getChildByName(\"btn_close\");\n        this.btn_tip = this.node_center.getChildByName(\"btn_tip\");\n        this.node_block_click_mask = this.node_center.getChildByName(\"node_block_click_mask\");\n        NodeHelper.setNodeSizeFullScreen(this.node_block_click_mask);\n        this.addListener();\n    }\n\n    public open() {\n        super.open();\n        this.initUI();\n        this.isInAnim = false;\n        this.node_block_click_mask.active = false;\n    }\n\n    private addListener() {\n        NodeHelper.setNodeClickEvent(this.btn_close, () => {\n            this.closeBySelf();\n        }, this);\n\n        NodeHelper.setNodeClickEvent(this.btn_tip, () => {\n\n        }, this);\n    }\n\n    private initUI() {\n        this.modeItems = [];\n        let modeData: ISetDataModeItem[] = [{\n            name: \"保卫小车\",\n            bg_path: \"\",\n            clickCb: () => {\n                this.showOneMode(0);\n                LogManager.log(\"保卫小车，启动！\");\n            }\n        }]\n        ResManager.getInstance().loadAsset(this.modeItemPath, LoadType.PrefableRes, this.bundleName, (prefab: Prefab) => {\n            if (!this.node_mode_items || !this.modeItems) {\n                LogManager.error(this.panelName, \"已经正在销毁了！！\");\n                return;\n            }\n            for (let i = 0; i < modeData.length; i++) {\n                let node = instantiate(prefab);\n                let itemCpt: LevelSelectModeItem = node.getComponent(LevelSelectModeItem);\n                if (itemCpt) {\n                    itemCpt.init();\n                    itemCpt.setData(modeData[i]);\n                }\n                this.node_mode_items.addChild(node);\n                this.modeItems.push(itemCpt);\n            }\n        })\n    }\n\n    private showOneMode(index: number) {\n        if (index >= this.modeItems.length) {\n            return;\n        }\n        if (this.isInAnim) {\n            return;\n        }\n        this.isInAnim = true;\n        this.node_block_click_mask.active = true;\n        for (let i = 0; i < this.modeItems.length; i++) {\n            const item = this.modeItems[i];\n            tween(item.node)\n                .to(this.tweenShowAnimData.animTime, { position: new Vec3(-300, -40), scale: new Vec3(1.2, 1.2, 1) });\n            const opacityCpt = item.getComponent(UIOpacity);\n            if (i != index && opacityCpt) {\n                tween(opacityCpt)\n                    .to(this.tweenShowAnimData.animTime, { opacity: 0 });\n            }\n        }\n    }\n\n    public close() {\n        super.close();\n    }\n\n    public dispose() {\n        super.dispose();\n        if (this.modeItems) {\n            for (let i = 0; i < this.modeItems.length; i++) {\n                this.modeItems[i]?.dispose();\n            }\n        }\n    }\n}"]}