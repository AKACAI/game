{"version":3,"sources":["file:///E:/education_game/game/assets/scripts/manager/map_manager/MapData.ts"],"names":["MapData","_decorator","Singleton","LogManager","ResManager","LoadType","ccclass","property","constructor","inited","init","finishCb","mapDatas","getInstance","loadBundle","loadMapData","mapName","warn","mapData","loadAsset","JSON","json","err","error"],"mappings":";;;wIA2BqBA,O;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA1BZC,MAAAA,U,OAAAA,U;;AACAC,MAAAA,S,iBAAAA,S;;AACFC,MAAAA,U;;AACEC,MAAAA,U,iBAAAA,U;AAAYC,MAAAA,Q,iBAAAA,Q;;;;;;;;;OAIf;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBN,U;;yBAmBTD,O,GAAN,MAAMA,OAAN;AAAA;AAAA,kCAAgC;AAI3CQ,QAAAA,WAAW,GAAG;AACV;AADU,eAHNC,MAGM,GAHY,KAGZ;AAEb;;AAEMC,QAAAA,IAAI,CAACC,QAAD,EAAwB;AAC/B,eAAKC,QAAL,GAAgB,EAAhB;AACA;AAAA;AAAA,wCAAWC,WAAX,GAAyBC,UAAzB,CAAoC,KAApC,EAA2C,MAAM;AAC7C,iBAAKL,MAAL,GAAc,IAAd;;AACA,gBAAIE,QAAJ,EAAc;AACVA,cAAAA,QAAQ;AACX;AACJ,WALD;AAMH;;AAEMI,QAAAA,WAAW,CAACC,OAAD,EAAkBL,QAAlB,EAA8D;AAC5E,cAAI,CAAC,KAAKD,IAAV,EAAgB;AACZ;AAAA;AAAA,0CAAWO,IAAX,CAAgB,gBAAhB;AACA;AACH;;AACD,cAAI,KAAKL,QAAL,CAAcI,OAAd,CAAJ,EAA4B;AACxB,gBAAIE,OAAO,GAAG,KAAKN,QAAL,CAAcI,OAAd,CAAd;AACAL,YAAAA,QAAQ,QAAR,YAAAA,QAAQ,CAAGO,OAAH,CAAR;AACH,WAHD,MAIK;AACD;AAAA;AAAA,0CAAWL,WAAX,GAAyBM,SAAzB,CAAmCH,OAAnC,EAA4C;AAAA;AAAA,sCAASI,IAArD,EAA2D,KAA3D,EAAmEC,IAAD,IAAqB;AACnF,kBAAIH,OAAO,GAAGG,IAAI,CAACA,IAAnB;AACA,mBAAKT,QAAL,CAAcI,OAAd,IAAyBE,OAAzB;AACAP,cAAAA,QAAQ,QAAR,YAAAA,QAAQ,CAAGO,OAAH,CAAR;AACH,aAJD,EAIII,GAAD,IAAS;AACR;AAAA;AAAA,4CAAWC,KAAX,CAAiBD,GAAjB;AACH,aAND;AAOH;AACJ;;AApC0C,O","sourcesContent":["\nimport { _decorator, JsonAsset } from \"cc\";\nimport { Singleton } from \"../../common/Singleton\";\nimport LogManager from \"../../utils/LogManager\";\nimport { ResManager, LoadType } from \"../ResManager\";\nimport { IPreInit } from \"../../common/IPreInit\";\nimport { PhysicsParam } from \"../../modules/game/ObjectBase\";\n\nconst { ccclass, property } = _decorator;\n\nexport interface IOpenObjectData {\n    objectId: number,\n    name: string,\n    pos: string,\n    rot: string,\n    sca: string,\n    objectType: number,\n    shapeParam: any,\n    objectParam: any,\n    physicsParam: PhysicsParam,\n}\n\nexport interface IOpenMapData {\n    mapId: number,\n    objectDatas: any,\n}\n\nexport default class MapData extends Singleton {\n    private inited: boolean = false;\n    private mapDatas: { [mapName: string]: IOpenMapData };\n\n    constructor() {\n        super();\n    }\n\n    public init(finishCb?: () => void) {\n        this.mapDatas = {};\n        ResManager.getInstance().loadBundle(\"map\", () => {\n            this.inited = true;\n            if (finishCb) {\n                finishCb();\n            }\n        });\n    }\n\n    public loadMapData(mapName: string, finishCb?: (mapData: IOpenMapData) => void) {\n        if (!this.init) {\n            LogManager.warn(\"MapManager未初始化\");\n            return;\n        }\n        if (this.mapDatas[mapName]) {\n            let mapData = this.mapDatas[mapName];\n            finishCb?.(mapData);\n        }\n        else {\n            ResManager.getInstance().loadAsset(mapName, LoadType.JSON, \"map\", (json: JsonAsset) => {\n                let mapData = json.json as IOpenMapData;\n                this.mapDatas[mapName] = mapData;\n                finishCb?.(mapData);\n            }, (err) => {\n                LogManager.error(err);\n            });\n        }\n    }\n}"]}