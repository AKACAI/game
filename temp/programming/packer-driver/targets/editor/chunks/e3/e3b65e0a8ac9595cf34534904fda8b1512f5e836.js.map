{"version":3,"sources":["file:///E:/education_game/game/assets/scripts/modules/game/ObjectFactory.ts"],"names":["_decorator","Node","Singleton","GameManager","ObjectBase","RightTriangleObject","SquareObject","ccclass","property","ObjectFactory","init","map_root","getInstance","gameRoot","getChildByName","objects_pre","nextInitManager","setNextInitManager","createObject","type","objectId","newNode","setParent","active","component","addComponent","objectType2component","create","push","getObject","shapeParam","pos","objectData","physicsParam","parent","object","shift","node","name","setPosition","setObject","givebackObject","destroyObject","destroy","ObjectType","Square","RightTriangle"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAkBC,MAAAA,I,OAAAA,I;;AAClBC,MAAAA,S,iBAAAA,S;;AACAC,MAAAA,W,iBAAAA,W;;AACAC,MAAAA,U,iBAAAA,U;;AACAC,MAAAA,mB,iBAAAA,mB;;AACAC,MAAAA,Y,iBAAAA,Y;;;;;;;;;OAGH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBR,U;;+BAGjBS,a,WADZF,OAAO,CAAC,eAAD,C,gBAAR,MACaE,aADb;AAAA;AAAA,kCACiE;AAItDC,QAAAA,IAAI,GAAG;AACV,eAAKC,QAAL,GAAgB;AAAA;AAAA,0CAAYC,WAAZ,GAA0BC,QAA1B,CAAmCC,cAAnC,CAAkD,UAAlD,CAAhB;AACA,eAAKC,WAAL,GAAmB,EAAnB;;AACA,cAAI,KAAKC,eAAT,EAA0B;AACtB,iBAAKA,eAAL,CAAqBN,IAArB;AACH;AACJ;;AAGMO,QAAAA,kBAAkB,CAACD,eAAD,EAAkC;AACvD,eAAKA,eAAL,GAAuBA,eAAvB;AACH;;AAEME,QAAAA,YAAY,CAACC,IAAD,EAAmBC,QAAnB,EAAkD;AACjE,cAAIC,OAAO,GAAG,IAAIpB,IAAJ,EAAd;AACAoB,UAAAA,OAAO,CAACC,SAAR,CAAkB,KAAKX,QAAvB;AACAU,UAAAA,OAAO,CAACE,MAAR,GAAiB,KAAjB;AACA,cAAIC,SAAS,GAAGH,OAAO,CAACI,YAAR,CAAqBC,oBAAoB,CAACP,IAAD,CAAzC,CAAhB;AACAK,UAAAA,SAAS,CAACG,MAAV;AACA,eAAKZ,WAAL,CAAiBa,IAAjB,CAAsBJ,SAAtB;AACA,iBAAOA,SAAP;AACH;;AAEMK,QAAAA,SAAS,CAACV,IAAD,EAAmBC,QAAnB,EAAqCU,UAArC,EAAsDC,GAAtD,EAAiEC,UAAjE,EAAkFC,YAAlF,EAA8GC,MAA9G,EAAyI;AACrJ,cAAIC,MAAM,GAAG,KAAKpB,WAAL,CAAiBqB,KAAjB,EAAb;;AACA,cAAI,CAACD,MAAL,EAAa;AACTA,YAAAA,MAAM,GAAG,KAAKjB,YAAL,CAAkBC,IAAlB,EAAwBC,QAAxB,CAAT;AACAe,YAAAA,MAAM,GAAG,KAAKpB,WAAL,CAAiBqB,KAAjB,EAAT;AACH;;AACDD,UAAAA,MAAM,CAACE,IAAP,CAAYC,IAAZ,GAAmBN,UAAU,CAACM,IAA9B;AACAH,UAAAA,MAAM,CAACE,IAAP,CAAYf,SAAZ,CAAsBY,MAAM,GAAGA,MAAH,GAAY,KAAKvB,QAA7C;AACAwB,UAAAA,MAAM,CAACE,IAAP,CAAYE,WAAZ,CAAwBR,GAAxB;AACAI,UAAAA,MAAM,CAACK,SAAP,CAAiBpB,QAAjB,EAA2BD,IAA3B,EAAiCW,UAAjC,EAA6CE,UAA7C,EAAyDC,YAAzD;AACAE,UAAAA,MAAM,CAACE,IAAP,CAAYd,MAAZ,GAAqB,IAArB;AACA,iBAAOY,MAAP;AACH;;AAEMM,QAAAA,cAAc,CAACN,MAAD,EAAqB;AACtCA,UAAAA,MAAM,CAACE,IAAP,CAAYd,MAAZ,GAAqB,KAArB;AACA,eAAKR,WAAL,CAAiBa,IAAjB,CAAsBO,MAAtB;AACH;;AAEMO,QAAAA,aAAa,CAACP,MAAD,EAAqB;AACrCA,UAAAA,MAAM,CAACE,IAAP,CAAYM,OAAZ;AACH;;AAhD4D,O;;4BAmDrDC,U,0BAAAA,U;AAAAA,QAAAA,U,CAAAA,U;AAAAA,QAAAA,U,CAAAA,U;eAAAA,U;;;AAMNlB,MAAAA,oB,GAAuB;AACzB,SAACkB,UAAU,CAACC,MAAZ,GAAqB;AAAA;AAAA;AAAA;AAAA,qCADI;AAEzB,SAACD,UAAU,CAACE,aAAZ,GAA4B;AAAA;AAAA;AAAA;AAAA;AAFH,O","sourcesContent":["import { _decorator, Vec3, Node } from \"cc\";\nimport { Singleton } from \"../../common/Singleton\";\nimport { GameManager } from \"../../manager/game_manager/GameManager\";\nimport { ObjectBase, PhysicsParam } from \"./ObjectBase\";\nimport { RightTriangleObject } from \"./game_objects/RightTriangleObject\";\nimport { SquareObject } from \"./game_objects/SquareObject\";\nimport { IPreInit } from \"../../common/IPreInit\";\n\nconst { ccclass, property } = _decorator;\n\n@ccclass('ObjectFactory')\nexport class ObjectFactory extends Singleton implements IPreInit {\n    private map_root: Node;\n    private objects_pre: ObjectBase[];\n\n    public init() {\n        this.map_root = GameManager.getInstance().gameRoot.getChildByName(\"map_root\");\n        this.objects_pre = [];\n        if (this.nextInitManager) {\n            this.nextInitManager.init();\n        }\n    }\n\n    public nextInitManager: IPreInit;\n    public setNextInitManager(nextInitManager: IPreInit): void {\n        this.nextInitManager = nextInitManager;\n    }\n\n    public createObject(type: ObjectType, objectId: number,): ObjectBase {\n        let newNode = new Node();\n        newNode.setParent(this.map_root);\n        newNode.active = false;\n        let component = newNode.addComponent(objectType2component[type]);\n        component.create();\n        this.objects_pre.push(component);\n        return component;\n    }\n\n    public getObject(type: ObjectType, objectId: number, shapeParam: any, pos: Vec3, objectData: any, physicsParam: PhysicsParam, parent?: Node): ObjectBase {\n        let object = this.objects_pre.shift();\n        if (!object) {\n            object = this.createObject(type, objectId);\n            object = this.objects_pre.shift();\n        }\n        object.node.name = objectData.name;\n        object.node.setParent(parent ? parent : this.map_root);\n        object.node.setPosition(pos);\n        object.setObject(objectId, type, shapeParam, objectData, physicsParam);\n        object.node.active = true;\n        return object;\n    }\n\n    public givebackObject(object: ObjectBase) {\n        object.node.active = false;\n        this.objects_pre.push(object);\n    }\n\n    public destroyObject(object: ObjectBase) {\n        object.node.destroy();\n    }\n}\n\nexport enum ObjectType {\n    Square = 1,\n    RightTriangle = 2,\n\n}\n\nconst objectType2component = {\n    [ObjectType.Square]: SquareObject || ObjectBase,\n    [ObjectType.RightTriangle]: RightTriangleObject || ObjectBase,\n}\n"]}