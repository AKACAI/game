{"version":3,"sources":["file:///E:/education_game/game/assets/scripts/utils/PriorityQueue.ts"],"names":["PriorityQueue","constructor","compare","_length","_queue","_compare","push","val","adjustUp","length","pop","result","adjustDown","top","queue","isEmpty","findIndex","equal","curIndex","find","index","print","toString","str","countCurDepth","j","console","log","child","parent","Math","floor"],"mappings":"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","sourcesContent":["export default class PriorityQueue<T extends any> {\n    private _length: number;\n    private _queue: T[];\n\n    /**返回 1：a>b  0：a=b  -1 a<b */\n    private _compare :(a: T, b: T) => number;\n\n    public constructor(compare: (a: T, b: T) => number) {\n        this._length = 0;\n        this._queue = [];\n        this._compare = compare;\n    }\n\n    public push(val: T) {\n        this._queue.push(val);\n        // 从该节点开始向上找父节点，直到父节点比他小为止\n        this.adjustUp(this._queue.length - 1);\n        this._length = this._queue.length;\n        // this.print((a)=>{\n        //     return a._nextTriggerTime;\n        // })\n    }\n\n    public pop(): T {\n        if (this._length <= 0) {\n            return null;\n        }\n        [this._queue[0], this._queue[this.length - 1]] = [this._queue[this.length - 1], this._queue[0]];\n        let result = this._queue.pop();\n        this.adjustDown(0);\n        this._length = this._queue.length;\n        // this.print((a)=>{\n        //     return a._nextTriggerTime;\n        // })\n        return result;\n    }\n\n    public top(): T {\n        if (this._length <= 0) {\n            return null;\n        }\n        //this.print();\n        return this._queue[0];\n    }\n\n    public get length(): number {\n        return this._length;\n    }\n\n    public get queue(): T[] {\n        return this._queue;\n    }\n\n    public isEmpty(): boolean {\n        return this.length == 0;\n    }\n\n    /**\n     * 找到第一个满足条件的元素的下标\n     * @param equal 当前元素是否为目标的标准\n     * @returns 第一个满足条件的元素的下标\n     */\n    public findIndex(equal: (obj: T) => boolean): number {\n        if (this._length <= 0) {\n            return -1;\n        }\n        if (equal) {\n            let curIndex = 0;\n            while(curIndex < this._length) {\n                if (equal(this._queue[curIndex])) {\n                    return curIndex;\n                }              \n                curIndex++;\n            }\n            return -1;\n        }\n        return -1;\n    }\n\n    /**\n     * 找到第一个满足条件的元素\n     * @param equal 当前元素是否为目标的标准\n     * @returns 第一个满足条件的元素\n     */\n    public find(equal: (obj: T) => boolean): T {\n        let index = this.findIndex(equal);\n        if (index == -1) {\n            return null;\n        }\n        return this.queue[index];\n    }\n\n    // 怎么打印泛型对象的内容呢？\n    public print(toString: (a: T) => string) {\n        if (toString) {\n            let str = \"\";\n            let curIndex = 0;\n            let countCurDepth = 1;\n            while(curIndex < this._length) {\n                for (let j = 0; j < countCurDepth && curIndex < this._length; j++) {\n                    // let parent = Math.floor((curIndex - 1) / 2);\n                    // if (parent >= 0) {\n                    //     if (this._compare(this._queue[curIndex], this._queue[parent]) == 1) {\n                    //         DebugTool.log(`第${curIndex}项：${toString(this._queue[curIndex])}\\t`, Color.GREEN);\n                    //     }\n                    //     else if (this._compare(this._queue[curIndex], this._queue[parent]) == 0) {\n                    //         DebugTool.log(`第${curIndex}项：${toString(this._queue[curIndex])}\\t`, Color.YELLOW);\n                    //     }\n                    //     else {\n                    //         DebugTool.log(`第${curIndex}项：${toString(this._queue[curIndex])}\\t`, Color.RED);\n                    //     }\n                    // }\n                    // else {\n                    //     DebugTool.log(`第${curIndex}项：${toString(this._queue[curIndex])}\\t`, Color.BLACK);\n                    // }\n                    str += `第${curIndex}项：${toString(this._queue[curIndex])}\\t`;    \n                    curIndex++;\n                }\n                str += \"\\n\";\n                countCurDepth *= 2;\n            }\n            //console.log(str);\n        }\n        else {\n            let str = \"\";\n            let curIndex = 0;\n            let countCurDepth = 1;\n            while(curIndex < this._length) {\n                for (let j = 0; j < countCurDepth && curIndex < this._length; j++) {\n                    str += `第${curIndex}项：${this._queue[curIndex]}\\t`;    \n                    curIndex++;\n                }\n                str += \"\\n\";\n                countCurDepth *= 2;\n            }\n            console.log(str);\n        }\n    }\n\n    private adjustUp(child: number) {\n        let parent = Math.floor((child - 1) / 2);\n        while (child > 0) {\n            if (this._compare(this._queue[child], this._queue[parent]) == -1) {\n                [this._queue[child], this._queue[parent]] = [this._queue[parent], this._queue[child]];\n                child = parent;\n                parent = Math.floor((child - 1) / 2);\n            }\n            else {\n                break;\n            }\n        }\n    }\n\n    private adjustDown(parent: number) {\n        let child = parent * 2 + 1;\n        while (child < this._queue.length) {\n            if (child + 1 < this._queue.length && this._compare(this._queue[child], this._queue[child + 1]) == 1) {\n                child++;\n            }\n            if (this._compare(this._queue[child], this._queue[parent]) == -1) {\n                [this._queue[child], this._queue[parent]] = [this._queue[parent], this._queue[child]];\n                parent = child;\n                child = 2 * parent + 1;\n            }\n            else {\n                break;\n            }\n        }\n    }\n}"]}