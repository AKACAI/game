{"version":3,"sources":["file:///D:/cocos_projects/physics_education_game/assets/scripts/GameApp.ts"],"names":["_decorator","Component","GameManager","GameState","UIManager","InputManager","MapManager","ObjectFactory","GameTipManager","ResManager","EventManager","EventConstants","TimerManager","ccclass","property","GameApp","gameLaunch","isOngoing","addEvent","GameControl","GameStart","onInitFinish","_resMgr","getInstance","_uiMgr","_inputMgr","_gameMgr","_objectFactory","_gameTipMgr","_mapMgr","setNextInitManager","undefined","init","start","addTimer","gameState","Ongoing","pause","Pause","resume","update","deltaTime"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;;AACZC,MAAAA,W,iBAAAA,W;AAAaC,MAAAA,S,iBAAAA,S;;AACbC,MAAAA,S,iBAAAA,S;;AACAC,MAAAA,Y,iBAAAA,Y;;AACAC,MAAAA,U,iBAAAA,U;;AACAC,MAAAA,a,iBAAAA,a;;AACAC,MAAAA,c,iBAAAA,c;;AACAC,MAAAA,U,iBAAAA,U;;AACFC,MAAAA,Y;;AACEC,MAAAA,c,kBAAAA,c;;AACFC,MAAAA,Y;;;;;;;;;OAED;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBd,U;;yBAGjBe,O,WADZF,OAAO,CAAC,SAAD,C,gBAAR,MACaE,OADb,SAC6Bd,SAD7B,CACuC;AAW5Be,QAAAA,UAAU,GAAS;AACtB,eAAKC,SAAL,GAAiB,KAAjB;AACA;AAAA;AAAA,4CAAaC,QAAb,CAAsB;AAAA;AAAA,gDAAeC,WAAf,CAA2BC,SAAjD,EAA4D,KAAKC,YAAjE,EAA+E,IAA/E;AAEA,eAAKC,OAAL,GAAe;AAAA;AAAA,wCAAWC,WAAX,EAAf;AACA,eAAKC,MAAL,GAAc;AAAA;AAAA,sCAAUD,WAAV,EAAd;AACA,eAAKE,SAAL,GAAiB;AAAA;AAAA,4CAAaF,WAAb,EAAjB;AACA,eAAKG,QAAL,GAAgB;AAAA;AAAA,0CAAYH,WAAZ,EAAhB;AACA,eAAKI,cAAL,GAAsB;AAAA;AAAA,8CAAcJ,WAAd,EAAtB;AACA,eAAKK,WAAL,GAAmB;AAAA;AAAA,gDAAeL,WAAf,EAAnB;AACA,eAAKM,OAAL,GAAe;AAAA;AAAA,wCAAWN,WAAX,EAAf;;AAEA,eAAKD,OAAL,CAAaQ,kBAAb,CAAgC,KAAKN,MAArC;;AACA,eAAKA,MAAL,CAAYM,kBAAZ,CAA+B,KAAKL,SAApC;;AACA,eAAKA,SAAL,CAAeK,kBAAf,CAAkC,KAAKJ,QAAvC;;AACA,eAAKA,QAAL,CAAcI,kBAAd,CAAiC,KAAKH,cAAtC;;AACA,eAAKA,cAAL,CAAoBG,kBAApB,CAAuC,KAAKF,WAA5C,EAhBsB,CAgBsC;;;AAC5D,eAAKA,WAAL,CAAiBE,kBAAjB,CAAoC,KAAKD,OAAzC,EAjBsB,CAiBsC;;;AAC5D,eAAKA,OAAL,CAAaC,kBAAb,CAAgCC,SAAhC;;AAEA,eAAKT,OAAL,CAAaU,IAAb;AACH;;AAEOX,QAAAA,YAAY,GAAG;AACnB,eAAKJ,SAAL,GAAiB,IAAjB;;AACA,eAAKS,QAAL,CAAcO,KAAd;;AACA;AAAA;AAAA,4CAAaC,QAAb,CAAsB,GAAtB,EAA2B,IAA3B,EAAiC,GAAjC,EAAsC,MAAM;AACxC,gBAAI,KAAKR,QAAL,CAAcS,SAAd,IAA2B;AAAA;AAAA,wCAAUC,OAAzC,EAAkD;AAC9C,mBAAKV,QAAL,CAAcW,KAAd;AACH,aAFD,MAEO,IAAI,KAAKX,QAAL,CAAcS,SAAd,IAA2B;AAAA;AAAA,wCAAUG,KAAzC,EAAgD;AACnD,mBAAKZ,QAAL,CAAca,MAAd;AACH;AACJ,WAND,EAMG,IANH;AAOH;;AAEMC,QAAAA,MAAM,CAACC,SAAD,EAA0B;AACnC,cAAI,CAAC,KAAKxB,SAAV,EAAqB;AACjB;AACH;;AACD;AAAA;AAAA,0CAAYM,WAAZ,GAA0BiB,MAA1B,CAAiCC,SAAjC;AACH;;AAnDkC,O","sourcesContent":["import { _decorator, Component } from \"cc\";\r\nimport { GameManager, GameState } from \"./manager/game_manager/GameManager\";\r\nimport { UIManager } from \"./manager/ui_manager/UIManager\";\r\nimport { InputManager } from \"./manager/InputManager\";\r\nimport { MapManager } from \"./manager/map_manager/MapManager\";\r\nimport { ObjectFactory } from \"./modules/game/ObjectFactory\";\r\nimport { GameTipManager } from \"./modules/ui/game_tip/GameTipManager\";\r\nimport { ResManager } from \"./manager/ResManager\";\r\nimport EventManager from \"./manager/event_manager/EventManager\";\r\nimport { EventConstants } from \"./manager/event_manager/EventConstants\";\r\nimport TimerManager from \"./manager/TimerManager\";\r\n\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('GameApp')\r\nexport class GameApp extends Component {\r\n    private isOngoing: boolean;\r\n\r\n    private _resMgr: ResManager;\r\n    private _inputMgr: InputManager;\r\n    private _uiMgr: UIManager;\r\n    private _objectFactory: ObjectFactory;\r\n    private _gameTipMgr: GameTipManager;\r\n    private _mapMgr: MapManager;\r\n    private _gameMgr: GameManager;\r\n\r\n    public gameLaunch(): void {\r\n        this.isOngoing = false;\r\n        EventManager.addEvent(EventConstants.GameControl.GameStart, this.onInitFinish, this);\r\n\r\n        this._resMgr = ResManager.getInstance();\r\n        this._uiMgr = UIManager.getInstance();\r\n        this._inputMgr = InputManager.getInstance();\r\n        this._gameMgr = GameManager.getInstance();\r\n        this._objectFactory = ObjectFactory.getInstance();\r\n        this._gameTipMgr = GameTipManager.getInstance();\r\n        this._mapMgr = MapManager.getInstance();\r\n\r\n        this._resMgr.setNextInitManager(this._uiMgr);\r\n        this._uiMgr.setNextInitManager(this._inputMgr);\r\n        this._inputMgr.setNextInitManager(this._gameMgr);\r\n        this._gameMgr.setNextInitManager(this._objectFactory);\r\n        this._objectFactory.setNextInitManager(this._gameTipMgr);   // 这些可以在gameManager之后\r\n        this._gameTipMgr.setNextInitManager(this._mapMgr);          // 这些可以在gameManager之后\r\n        this._mapMgr.setNextInitManager(undefined);\r\n\r\n        this._resMgr.init();\r\n    }\r\n\r\n    private onInitFinish() {\r\n        this.isOngoing = true;\r\n        this._gameMgr.start();\r\n        TimerManager.addTimer(200, true, 200, () => {\r\n            if (this._gameMgr.gameState == GameState.Ongoing) {\r\n                this._gameMgr.pause();\r\n            } else if (this._gameMgr.gameState == GameState.Pause) {\r\n                this._gameMgr.resume();\r\n            }\r\n        }, null);\r\n    }\r\n\r\n    public update(deltaTime: number): void {\r\n        if (!this.isOngoing) {\r\n            return;\r\n        }\r\n        GameManager.getInstance().update(deltaTime);\r\n    }\r\n}\r\n\r\n\r\n"]}