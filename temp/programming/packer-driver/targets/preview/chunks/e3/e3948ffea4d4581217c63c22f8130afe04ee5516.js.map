{"version":3,"sources":["file:///D:/cocos_projects/physics_education_game/assets/scripts/common/m_scroll_view/MScrollView.ts"],"names":["_decorator","CCInteger","Component","Enum","instantiate","Mask","Node","Prefab","UITransform","MScrollItem","ccclass","property","requireComponent","ScrollLayoutType","ScrollOrderType","MScrollView","type","tooltip","init","itemPrefab","console","error","node","name","canScroll","contentNode","parent","setPosition","transform","addComponent","nodeTransform","getComponent","setAnchorPoint","anchorPoint","setContentSize","contentSize","layoutType","Horizon","item","itemLength","x","viewLength","destroy","y","count","Math","ceil","spacing","scrollItems","i","active","scrollItem","push","initFunc","on","EventType","MOUSE_WHEEL","onMouseWheel","setData","itemsData","allItemNum","length","allProgressLength","beginSpacing","endSpacing","leftBorder","rightBorder","curProgressPos","updateProgress","orderType","Forward","Verticle","getItemPos","index","deltaPos","firstIndex","curItemPos","firstPosX","showCount","min","event","getScrollY","dispose","off"],"mappings":"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","sourcesContent":["import { MScrollItem } from 'MScrollItem';\r\nimport { _decorator, CCInteger, Component, Enum, EventMouse, instantiate, Mask, Node, Prefab, UITransform, Vec2 } from 'cc';\r\nconst { ccclass, property, requireComponent } = _decorator;\r\n\r\nexport enum ScrollLayoutType {\r\n    Horizon = 1,\r\n    Verticle = 2,\r\n}\r\n\r\nexport enum ScrollOrderType {\r\n    Forward = 1,    // 正向排序（从前往后\r\n    Reverse = 2,    // 逆向排序（从后往前\r\n}\r\n\r\n@ccclass('MScrollView')\r\n@requireComponent(Mask)\r\nexport class MScrollView extends Component {\r\n    @property({ type: Prefab, tooltip: \"用于生成可展示内容的预制体引用\" })\r\n    protected itemPrefab: Prefab;\r\n    @property({ type: Enum(ScrollLayoutType), tooltip: \"布局类型\" })\r\n    protected layoutType: ScrollLayoutType = ScrollLayoutType.Verticle;\r\n    @property({ type: Enum(ScrollLayoutType), tooltip: \"排序类型\" })\r\n    protected orderType: ScrollOrderType = ScrollOrderType.Forward;\r\n    @property({ type: [CCInteger], tooltip: \"item之间的间距\" })\r\n    protected spacing: number = 0;\r\n    @property({ type: [CCInteger], tooltip: \"与起始位置的间距\" })\r\n    protected beginSpacing: number = 0;\r\n    @property({ type: [CCInteger], tooltip: \"与终止位置的间距\" })\r\n    protected endSpacing: number = 0;\r\n\r\n    protected scrollItems: MScrollItem[];   // 实例化的item\r\n    protected itemsData: any[];             // item的数据\r\n\r\n    protected allItemNum: number;           // 所有的item的总数\r\n    protected allProgressLength: number;    // 所有的进度的长度\r\n    protected leftBorder: number;           // 进度为0时的坐标值，也就是左边界\r\n    protected rightBorder: number;          // 进度为1时的坐标值，也就是右边界\r\n    protected curProgressPos: number;        // 当前的进度坐标\r\n    protected viewLength: number;           // 可视区域长度\r\n    protected itemLength: number;           // item的长度\r\n    protected canScroll: boolean;\r\n\r\n    protected contentNode: Node;      // 实例化的item的父节点\r\n\r\n    public init() {\r\n        if (!this.itemPrefab) {\r\n            console.error(\"请给滚动容器\", this.node.name, \"绑定item预制体！！！\")\r\n            return;\r\n        }\r\n        this.canScroll = false;\r\n        this.contentNode = new Node(\"content\");\r\n        this.contentNode.parent = this.node;\r\n        this.contentNode.setPosition(0, 0, 0);\r\n        let transform = this.contentNode.addComponent(UITransform);\r\n        let nodeTransform = this.node.getComponent(UITransform);\r\n        transform.setAnchorPoint(nodeTransform.anchorPoint);\r\n        transform.setContentSize(nodeTransform.contentSize);\r\n        if (this.layoutType == ScrollLayoutType.Horizon) {\r\n            let item = instantiate(this.itemPrefab);\r\n            this.itemLength = item.getComponent(UITransform).contentSize.x;\r\n            this.viewLength = transform.contentSize.x;\r\n            item.destroy();\r\n        }\r\n        else {\r\n            let item = instantiate(this.itemPrefab);\r\n            this.itemLength = item.getComponent(UITransform).contentSize.y;\r\n            this.viewLength = transform.contentSize.y;\r\n            item.destroy();\r\n        }\r\n        let count = Math.ceil((this.viewLength + this.spacing) / (this.spacing + this.itemLength));\r\n        this.scrollItems = [];\r\n        for (let i = 0; i < count; i++) {\r\n            let node = instantiate(this.itemPrefab);\r\n            node.parent = this.contentNode;\r\n            node.active = false;\r\n            let scrollItem = node.getComponent(MScrollItem);\r\n            scrollItem.init();\r\n            this.scrollItems.push(scrollItem);\r\n        }\r\n\r\n        this.initFunc();\r\n    }\r\n\r\n    protected initFunc() {\r\n        this.node.on(Node.EventType.MOUSE_WHEEL, this.onMouseWheel, this);\r\n    }\r\n\r\n    public setData(itemsData: any[], canScroll: boolean) {\r\n        if (!this.itemPrefab) {\r\n            console.error(\"请给滚动容器\", this.node.name, \"绑定item预制体！！！\")\r\n            return;\r\n        }\r\n        this.canScroll = canScroll;\r\n        this.itemsData = itemsData;\r\n        this.allItemNum = this.itemsData.length;\r\n        this.allProgressLength = this.beginSpacing + this.endSpacing + this.itemLength + (this.allItemNum - 1) * (this.itemLength + this.spacing);\r\n        this.leftBorder = 0;\r\n        this.rightBorder = this.allProgressLength - this.viewLength;\r\n        if (this.itemsData.length >= this.scrollItems.length) {\r\n            this.curProgressPos = 0;\r\n            this.updateProgress(0);\r\n        }\r\n        else {\r\n            this.curProgressPos = 0;\r\n            if (this.layoutType == ScrollLayoutType.Horizon) {\r\n                if (this.orderType == ScrollOrderType.Forward) {\r\n                    for (let i = 0; i < this.itemsData.length; i++) {\r\n                        this.scrollItems[i].node.active = true;\r\n                        this.scrollItems[i].node.setPosition(i * (this.itemLength + this.spacing) + this.itemLength / 2, 0, 0);\r\n                        this.scrollItems[i].setData(this.itemsData[i]);\r\n                    }\r\n                }\r\n                // else if (this.orderType == ScrollOrderType.Reverse) {\r\n                //     for (let i = 0; i < this.itemsData.length; i++) {\r\n                //         this.scrollItems[i].node.active = true;\r\n                //         this.scrollItems[i].node.setPosition(i * (this.itemLength + this.spacing) + this.itemLength / 2, 0, 0);\r\n                //         this.scrollItems[i].setData(this.itemsData[i]);\r\n                //     }\r\n                // }\r\n            }\r\n            else if (this.layoutType == ScrollLayoutType.Verticle) {\r\n                if (this.orderType == ScrollOrderType.Forward) {\r\n                    for (let i = 0; i < this.itemsData.length; i++) {\r\n                        this.scrollItems[i].node.active = true;\r\n                        this.scrollItems[i].node.setPosition(0, -i * (this.itemLength + this.spacing) + this.itemLength / 2, 0);\r\n                        this.scrollItems[i].setData(this.itemsData[i]);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    getItemPos(index: number): number {\r\n        if (index == 0) {\r\n            if (this.layoutType == ScrollLayoutType.Verticle && this.orderType == ScrollOrderType.Forward) {\r\n                return - this.beginSpacing - this.itemLength / 2;\r\n            }\r\n            else if (this.layoutType == ScrollLayoutType.Horizon && this.orderType == ScrollOrderType.Forward) {\r\n                return this.beginSpacing + this.itemLength / 2;\r\n            }\r\n        }\r\n        else {\r\n            if (this.layoutType == ScrollLayoutType.Verticle && this.orderType == ScrollOrderType.Forward) {\r\n                return this.getItemPos(index - 1) - this.itemLength - this.spacing;\r\n            }\r\n            else if (this.layoutType == ScrollLayoutType.Horizon && this.orderType == ScrollOrderType.Forward) {\r\n                return this.getItemPos(index - 1) + this.itemLength + this.spacing;\r\n            }\r\n        }\r\n    }\r\n\r\n    protected updateProgress(deltaPos: number) {\r\n        this.curProgressPos += deltaPos;\r\n        if (this.curProgressPos > this.rightBorder) {\r\n            this.curProgressPos = this.rightBorder;\r\n        }\r\n        if (this.curProgressPos < this.leftBorder) {\r\n            this.curProgressPos = this.leftBorder;\r\n        }\r\n        let firstIndex = 0;\r\n        let curItemPos = this.getItemPos(0);\r\n        while (curItemPos + this.itemLength / 2 < this.curProgressPos) {\r\n            firstIndex++;\r\n            curItemPos += this.spacing + this.itemLength;\r\n        }\r\n        let firstPosX = curItemPos - this.curProgressPos;       // 第一个在视窗里面的item的横坐标\r\n        let showCount = Math.min(this.itemsData.length - firstIndex, this.scrollItems.length);\r\n        if (this.layoutType == ScrollLayoutType.Horizon) {\r\n            for (let i = 0; i < showCount; i++) {\r\n                this.scrollItems[i].node.active = true;\r\n                this.scrollItems[i].node.setPosition(firstPosX + i * (this.itemLength + this.spacing), 0, 0);\r\n                this.scrollItems[i].setData(this.itemsData[firstIndex + i]);\r\n            }\r\n        }\r\n        else if (this.layoutType == ScrollLayoutType.Verticle) {\r\n            for (let i = 0; i < showCount; i++) {\r\n                this.scrollItems[i].node.active = true;\r\n                this.scrollItems[i].node.setPosition(0, firstPosX + i * (this.itemLength + this.spacing), 0);\r\n                this.scrollItems[i].setData(this.itemsData[firstIndex + i]);\r\n            }\r\n        }\r\n    }\r\n\r\n    protected onMouseWheel(event: EventMouse) {\r\n        if (!this.canScroll) {\r\n            return;\r\n        }\r\n        if (event.getScrollY() > 0) {\r\n            this.updateProgress(-30);\r\n        }\r\n        else if (event.getScrollY() < 0) {\r\n            this.updateProgress(30);\r\n        }\r\n    }\r\n\r\n    public dispose() {\r\n        this.node.off(Node.EventType.MOUSE_WHEEL);\r\n        for (let i = 0; i < this.scrollItems.length; i++) {\r\n            this.scrollItems[i].dispose();\r\n        }\r\n        delete this.scrollItems;\r\n    }\r\n}\r\n\r\n"]}